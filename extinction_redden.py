import numpy as np

def A_wave(v, Rv, R_band, EBV):
	"""
	v : the wavelength of filter, in unit "10^(-10)m"
	EBV : E(B-V)
	Rv : 3.1 for Milky Way
	"""
	x = 10**4/v
	A_filter = R_band * EBV
	if 0.3<=x<1.1:
		"""
		infrared
		"""
		a = 0.574*x**1.61
		b = -0.527*x**1.61

	elif 1.1<=x<3.3:
		"""
		Optical/NIR
		"""
		y = x - 1.82
		a = (1. + 0.17699*y - 0.50447*y**2 - 0.02427*y**3 
			+ 0.72085*y**4 + 0.01979*y**5 - 0.77530*y**6 + 0.32999*y**7)
		b = (1.41338*y + 2.28305*y**2 + 1.07233*y**3 - 5.38434*y**4
			- 0.62251*y**5 + 5.30260*y**6 - 2.09002*y**7)

	elif 3.3<=x<8:
		"""
		Ultraviolet
		"""
		if x<5.9:
			Fa = 0.
			Fb = 0.
		elif 5.9<=x<8.:
			Fa = -0.04473*(x - 5.9)**2 - 0.009779*(x - 5.9)**3
			Fb = 0.2130*(x - 5.9)**2 + 0.1207*(x - 5.9)**3
			
		a = 1.752 - 0.316*x - 0.104/((x - 4.67)**2 + 0.341) + Fa
		b = -3.090 + 1.825*x + 1.206/((x - 4.62)**2 + 0.263) + Fb

	elif 8.<=x<=10.:
		"""
		Far-UV
		"""
		a = -1.073 - 0.628*(x - 8) + 0.137*(x - 8)**2 - 0.070*(x - 8)**3
		b = 13.670 + 4.257*(x - 8) - 0.420*(x - 8)**2 + 0.374*(x - 8)**3

	Aw = (a + b/Rv)*A_filter
	return Aw
